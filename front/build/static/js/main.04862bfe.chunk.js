(this["webpackJsonpfront-end"]=this["webpackJsonpfront-end"]||[]).push([[0],{14:function(e,t,n){},15:function(e,t,n){},16:function(e,t,n){},17:function(e,t,n){"use strict";n.r(t);var s=n(0),c=n(2),a=n.n(c),r=n(8),i=n.n(r),o=(n(14),n(3)),u=n(4),l=n(6),h=n(5),d=(n(15),n(1)),m=(n(16),function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var s;return Object(o.a)(this,n),(s=t.call(this,e)).handleUserBtn=function(e){s.fetchCurrentSender(e),s.fetchMassages(e),s.fetchMyMassages(e);var t=document.getElementById("msg");document.getElementById("sbtn").className="sendbtn",t.className="sendfield"},s.state={massages:[],users:[],myMassages:[],currentUser:[{id:2,username:"admin",email:""}],currentSender:[],activeItem:{id:null,text:"",picture:null,sender:null,reciever:null}},s.getCookie=s.getCookie.bind(Object(d.a)(s)),s.fetchMassages=s.fetchMassages.bind(Object(d.a)(s)),s.fetchMyMassages=s.fetchMyMassages.bind(Object(d.a)(s)),s.fetchUsers=s.fetchUsers.bind(Object(d.a)(s)),s.onChangeHandle=s.onChangeHandle.bind(Object(d.a)(s)),s.onSubmitHandle=s.onSubmitHandle.bind(Object(d.a)(s)),s.fetchCurrentSender=s.fetchCurrentSender.bind(Object(d.a)(s)),s.fetchMassagesReload=s.fetchMassagesReload.bind(Object(d.a)(s)),s.scrollToTop=s.scrollToTop.bind(Object(d.a)(s)),s}return Object(u.a)(n,[{key:"getCookie",value:function(e){var t=null;if(document.cookie&&""!==document.cookie)for(var n=document.cookie.split(";"),s=0;s<n.length;s++){var c=n[s].trim();if(c.substring(0,e.length+1)===e+"="){t=decodeURIComponent(c.substring(e.length+1));break}}return t}},{key:"componentDidMount",value:function(){this.fetchUsers()}},{key:"componentDidUpdate",value:function(){this.scrollToTop()}},{key:"fetchUsers",value:function(e){var t=this;console.log("Fetching users ...");var n=this.state.currentUser[0].id;fetch("http://127.0.0.1:8000/u/".concat(n)).then((function(e){return e.json()})).then((function(e){return t.setState({users:e})}))}},{key:"fetchMassages",value:function(e){var t=this,n=e.target.value,s=this.state.currentUser[0].id;console.log("Fetching msgs ...",n,s),fetch("http://127.0.0.1:8000/p/".concat(n,"/").concat(s)).then((function(e){return e.json()})).then((function(e){return t.setState({massages:e})}))}},{key:"fetchMyMassages",value:function(e){var t=this,n=e.target.value,s=this.state.currentUser[0].id;console.log("Fetching msgs ...",s,n),fetch("http://127.0.0.1:8000/p/".concat(s,"/").concat(n)).then((function(e){return e.json()})).then((function(e){return t.setState({myMassages:e})}))}},{key:"fetchCurrentSender",value:function(e){var t=this,n=e.target.value;console.log("Fetching current user ...",n),fetch("http://127.0.0.1:8000/uf/".concat(n)).then((function(e){return e.json()})).then((function(e){return t.setState({currentSender:e})}))}},{key:"onChangeHandle",value:function(e){var t=e.target.value,n=this.state.currentSender[0].id,s=this.state.currentUser[0].id;this.setState({activeItem:{id:null,text:t,picture:null,sender:n,reciever:s}}),console.log(t,n,s)}},{key:"onSubmitHandle",value:function(){var e=this.state.activeItem;console.log(e);var t=this.getCookie("csrftoken");fetch("http://127.0.0.1:8000/m",{method:"POST",headers:{"Content-type":"application/json","X-CSRFToken":t},body:JSON.stringify(this.state.activeItem)}).catch((function(e){console.log("ERROR:",e)})),this.setState({activeItem:{id:null,text:"",picture:null,sender:null,reciever:null}}),this.fetchMassagesReload()}},{key:"fetchMassagesReload",value:function(){var e=this,t=this.state.currentSender[0].id,n=this.state.currentUser[0].id;console.log("Fetching msgs ...",t,n),fetch("http://127.0.0.1:8000/p/".concat(t,"/").concat(n)).then((function(e){return e.json()})).then((function(t){return e.setState({massages:t})})),fetch("http://127.0.0.1:8000/p/".concat(n,"/").concat(t)).then((function(e){return e.json()})).then((function(t){return e.setState({myMassages:t})}))}},{key:"scrollToTop",value:function(){var e=document.getElementById("sdbj");e.scrollTop=e.scrollHeight}},{key:"render",value:function(){var e=this.state.massages,t=this.state.myMassages,n=this.state.users,c=this;return Object(s.jsxs)("div",{children:[Object(s.jsxs)("div",{className:"users",children:[Object(s.jsx)("h3",{children:"Your massages"}),n.map((function(e,t){return Object(s.jsx)("div",{className:"user",children:Object(s.jsx)("button",{value:e.id,onClick:c.handleUserBtn,className:"UsernameButton",children:e.username})},t)}))]}),Object(s.jsxs)("div",{className:"msgBox",id:"sdbj",children:[Object(s.jsx)("div",{className:"sms",children:e.map((function(e,t){return Object(s.jsx)("div",{className:"msg",children:Object(s.jsxs)("div",{className:"textmsg",children:[Object(s.jsx)("p",{className:"author",children:c.state.currentSender[0].username}),Object(s.jsx)("p",{className:"value",children:e.text}),Object(s.jsx)("p",{className:"date",children:e.time})]})},t)}))}),Object(s.jsx)("div",{className:"mms",children:t.map((function(e,t){return Object(s.jsx)("div",{className:"msg",children:Object(s.jsxs)("div",{className:"textmsg",children:[Object(s.jsx)("p",{className:"date",children:e.time}),Object(s.jsx)("p",{className:"value",children:e.text}),Object(s.jsx)("p",{className:"author",children:c.state.currentUser[0].username})]})},t)}))}),Object(s.jsxs)("div",{className:"sendbox fixed-bottom",children:[Object(s.jsx)("input",{type:"text",name:"msg",id:"msg",className:"hidden",value:this.state.activeItem.text,onChange:this.onChangeHandle}),Object(s.jsx)("button",{className:"hidden",id:"sbtn",onClick:this.onSubmitHandle,children:"Send"})]})]})]})}}]),n}(c.Component)),j=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return Object(s.jsx)("div",{children:Object(s.jsx)(m,{})})}}]),n}(c.Component);i.a.render(Object(s.jsx)(a.a.StrictMode,{children:Object(s.jsx)(j,{})}),document.getElementById("root"))}},[[17,1,2]]]);
//# sourceMappingURL=main.04862bfe.chunk.js.map